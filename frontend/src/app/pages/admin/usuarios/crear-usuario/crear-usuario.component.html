<div class="container">
  <app-sidebar></app-sidebar>
  <div class="main-content">
    <app-navbar></app-navbar>
    <div class="form-container">
      <h2>Crear Usuario</h2>
      <button (click)="irHome()" class="icon-button">
        <span class="material-icons">arrow_back</span>
      </button>
      <form (ngSubmit)="crearUsuario()" #usuarioForm="ngForm">
        <div class="form-group">
          <label for="nombre">Nombre </label>
          <input type="text" id="nombre" name="nombre" [(ngModel)]="usuario.nombre" required />
        </div>
        <div class="form-group">
          <label for="apellido">Apellido</label>
          <input type="text" id="apellido" name="apellido" [(ngModel)]="usuario.apellido" required />
        </div>
        <div class="form-group">
          <label for="correoElectronico">Correo Electrónico</label>
          <input type="email" id="correoElectronico" name="correoElectronico" [(ngModel)]="usuario.correo"
                 autocomplete="username" required />
        </div>
        <div class="form-group">
          <label for="rol">Rol</label>
          <select id="rol" name="rol" [(ngModel)]="usuario.admin" required>
            <option [value]="false">Usuario</option>
            <option [value]="true">Administrador</option>
          </select>
        </div>
        <div class="form-group">
          <label for="password">Contraseña</label>
          <div class="password-container">
            <div class="password-wrapper">
              <input id="password" name="password" [type]="passwordFieldType" [(ngModel)]="usuario.password"
                     placeholder="Ingresa tu contraseña" autocomplete="current-password" required />
            </div>
            <button type="button" (click)="togglePasswordVisibility()" class="toggle-password">
              <mat-icon>{{ passwordFieldType === 'password' ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
          </div>
        </div>
        <div class="form-group">
          <label for="repeatPassword">Repetir Contraseña</label>
          <div class="password-container">
          <div class="password-wrapper">
            <input id="repeatPassword" name="repeatPassword" [type]="passwordFieldType" [(ngModel)]="repeatPassword"
                   placeholder="Repite tu contraseña" required />
          </div>
          <button type="button" (click)="toggleRepeatPasswordVisibility()" class="toggle-repeat-password-btn">
            <mat-icon>{{ repeatPasswordFieldType === 'password' ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          </div>
          @if(passwordMismatch){
          <div class="error-message">
            Las contraseñas no coinciden.
          </div>
          }
        </div>
        <button type="submit" [disabled]="usuarioForm.invalid || passwordMismatch">
          <span class="material-symbols-outlined icon">
            person_add
          </span>
          <strong>Crear Usuario</strong>
        </button>
      </form>
    </div>
  </div>
</div>